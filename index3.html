<!DOCTYPE html>
<html>
<head>
  <title>Anti-Burn Protection - Cánticos de Victoria</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Quicksand', sans-serif;
      margin: 0;
      padding: 20px;
      text-align: center;
      color: #333;
      transition: background-color 0.3s;
    }
    
    body.dark-mode {
      background-color: #181818;
      color: #eee;
    }
    
    .screen-protection-notice {
      display: none; /* Hidden by default */
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(93, 92, 222, 0.9);
      color: white;
      padding: 10px 15px;
      border-radius: 8px;
      font-size: 14px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      z-index: 100;
      transition: opacity 0.5s;
    }
    
    .lyrics-container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 8px;
      transition: border-color 0.3s;
    }
    
    body.dark-mode .lyrics-container {
      border-color: #444;
    }
    
    .lyrics {
      line-height: 1.6;
      font-size: 20px;
    }
    
    .lyrics p {
      margin: 10px 0;
      transition: color 5s ease;
    }
    
    .controls {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    
    button {
      background: #5D5CDE;
      color: white;
      border: none;
      padding: 8px 16px;
      margin: 0 5px;
      cursor: pointer;
      border-radius: 4px;
      font-family: inherit;
      transition: background 0.3s;
    }
    
    button:hover {
      background: #4a49b9;
    }
    
    button.secondary {
      background: #777;
    }
    
    button.secondary:hover {
      background: #666;
    }
    
    .status {
      margin-top: 15px;
      font-style: italic;
      font-size: 14px;
      color: #777;
    }
    
    body.dark-mode .status {
      color: #aaa;
    }
    
    .protection-info {
      margin-top: 40px;
      font-size: 14px;
      color: #666;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      border-top: 1px solid #eee;
      padding-top: 20px;
    }
    
    body.dark-mode .protection-info {
      color: #aaa;
      border-top-color: #333;
    }
    
    /* This class only exists on large screens */
    .large-screen-only {
      display: none;
    }
    
    /* Media query for large screens */
    @media (min-width: 1024px) {
      .large-screen-only {
        display: block;
      }
    }
    
    /* For demo purposes - toggle between mobile/desktop view */
    .view-toggle {
      position: fixed;
      bottom: 10px;
      left: 10px;
      background: #333;
      color: white;
      padding: 5px 10px;
      border-radius: 3px;
      z-index: 100;
      font-size: 12px;
    }
    
    /* countdown circle */
    .countdown-circle {
      position: fixed;
      bottom: 70px;
      right: 20px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(93, 92, 222, 0.2);
      display: none;
      z-index: 100;
    }
    
    .countdown-circle-inner {
      position: absolute;
      top: 5px;
      left: 5px;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background-color: #5D5CDE;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 12px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Cánticos de Victoria</h1>
  <p>Text Color Cycling for Screen Protection (Large Screens Only)</p>
  
  <div class="lyrics-container">
    <div class="lyrics" id="lyrics">
      <p>Oh Dios, tú eres mi Dios, con ansias te busco</p>
      <p>Mi alma tiene sed de ti, mi cuerpo te anhela</p>
      <p>Como tierra seca, resquebrajada, sin agua</p>
      <p>Te he visto en el santuario</p>
      <p>Y he contemplado tu poder y tu gloria</p>
      <p>Tu amor es mejor que la vida</p>
    </div>
  </div>
  
  <div class="controls">
    <button id="toggleThemeBtn">Toggle Dark Mode</button>
    <button id="disableProtectionBtn" class="secondary">Disable Protection</button>
  </div>
  
  <div class="status" id="status">
    <span class="large-screen-only">Screen protection active: Will activate after 5 minutes of inactivity</span>
    <span id="mobile-notice" style="display:none">Screen protection only available on large screens</span>
  </div>
  
  <div class="protection-info large-screen-only">
    <p><strong>About Screen Protection:</strong> On large screens, static text can cause pixel burn-in over time. After 5 minutes of inactivity, this app will gradually cycle text colors to prevent damage to your display. Any interaction will reset the timer.</p>
  </div>
  
  <div class="screen-protection-notice" id="protectionNotice">
    Screen protection activating soon...
  </div>
  
  <div class="countdown-circle" id="countdownCircle">
    <div class="countdown-circle-inner" id="countdownValue"></div>
  </div>
  
  <!-- For demo purposes only - toggle between mobile/desktop view -->
  <div class="view-toggle" id="viewToggle">
    Currently showing: <span id="currentView">Desktop</span> view
  </div>
  
  <script>
    // DOM elements
    const lyrics = document.getElementById('lyrics');
    const status = document.getElementById('status');
    const toggleThemeBtn = document.getElementById('toggleThemeBtn');
    const disableProtectionBtn = document.getElementById('disableProtectionBtn');
    const protectionNotice = document.getElementById('protectionNotice');
    const countdownCircle = document.getElementById('countdownCircle');
    const countdownValue = document.getElementById('countdownValue');
    const mobileNotice = document.getElementById('mobile-notice');
    const viewToggle = document.getElementById('viewToggle');
    const currentView = document.getElementById('currentView');
    
    // State variables
    let isProtectionActive = false;
    let cycleInterval;
    let inactivityTimeout;
    let countdownInterval;
    let secondsLeft = 300; // 5 minutes
    let isLargeScreen = window.innerWidth >= 1024;
    let protectionEnabled = true;
    
    // Get all lyric lines
    const lines = lyrics.querySelectorAll('p');
    
    // For the demo - toggle between mobile/desktop view
    viewToggle.addEventListener('click', () => {
      isLargeScreen = !isLargeScreen;
      currentView.textContent = isLargeScreen ? 'Desktop' : 'Mobile';
      document.querySelectorAll('.large-screen-only').forEach(el => {
        el.style.display = isLargeScreen ? 'block' : 'none';
      });
      mobileNotice.style.display = isLargeScreen ? 'none' : 'inline';
      
      // Reset the protection state when switching views
      if (isProtectionActive) {
        stopColorCycling();
      }
      resetInactivityTimer();
    });
    
    // Initialize the view state
    window.addEventListener('DOMContentLoaded', () => {
      isLargeScreen = window.innerWidth >= 1024;
      currentView.textContent = isLargeScreen ? 'Desktop' : 'Mobile';
      document.querySelectorAll('.large-screen-only').forEach(el => {
        el.style.display = isLargeScreen ? 'block' : 'none';
      });
      mobileNotice.style.display = isLargeScreen ? 'none' : 'inline';
    });
    
    // Toggle dark mode
    toggleThemeBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
    });
    
    // Disable protection
    disableProtectionBtn.addEventListener('click', () => {
      protectionEnabled = !protectionEnabled;
      disableProtectionBtn.textContent = protectionEnabled 
        ? 'Disable Protection' 
        : 'Enable Protection';
      
      if (!protectionEnabled && isProtectionActive) {
        stopColorCycling();
      }
      
      if (protectionEnabled) {
        resetInactivityTimer();
        status.querySelector('.large-screen-only').textContent = 
          'Screen protection active: Will activate after 5 minutes of inactivity';
      } else {
        clearTimeout(inactivityTimeout);
        hideCountdown();
        status.querySelector('.large-screen-only').textContent = 
          'Screen protection disabled by user';
      }
    });
    
    function startColorCycling() {
      if (isProtectionActive || !isLargeScreen || !protectionEnabled) return;
      
      isProtectionActive = true;
      status.querySelector('.large-screen-only').textContent = 
        'Color cycling active - protecting your screen';
      
      hideCountdown();
      
      // Set initial colors to ensure smooth transitions
      lines.forEach(line => {
        line.style.transition = 'color 5s ease';
        line.style.color = document.body.classList.contains('dark-mode') 
          ? 'rgba(238, 238, 238, 1)' 
          : 'rgba(51, 51, 51, 1)';
      });
      
      // Color cycling function
      let hue = 0;
      let brightness = document.body.classList.contains('dark-mode') ? 40 : 30;
      let direction = 1; // For brightness oscillation
      
      cycleInterval = setInterval(() => {
        // Cycle through colors
        hue = (hue + 1) % 360;
        
        // Oscillate brightness to keep text readable but prevent burn-in
        brightness += direction * 0.5;
        if (document.body.classList.contains('dark-mode')) {
          // Dark mode - keep brightness higher
          if (brightness >= 70) direction = -1;
          if (brightness <= 40) direction = 1;
        } else {
          // Light mode - keep brightness lower
          if (brightness >= 50) direction = -1;
          if (brightness <= 30) direction = 1;
        }
        
        // Apply to each line with a slight delay between them
        lines.forEach((line, index) => {
          setTimeout(() => {
            // Use HSL for better visual transitions
            line.style.color = `hsl(${(hue + index * 30) % 360}, 80%, ${brightness}%)`;
          }, index * 150);
        });
      }, 250);
    }
    
    function stopColorCycling() {
      if (!isProtectionActive) return;
      
      clearInterval(cycleInterval);
      isProtectionActive = false;
      
      // Reset to normal color with a transition
      lines.forEach(line => {
        line.style.transition = 'color 1s ease';
        line.style.color = '';
      });
      
      status.querySelector('.large-screen-only').textContent = 
        'Screen protection active: Will activate after 5 minutes of inactivity';
        
      resetInactivityTimer();
    }
    
    function resetInactivityTimer() {
      // Clear any existing timers
      clearTimeout(inactivityTimeout);
      clearInterval(countdownInterval);
      
      // Hide the notice
      protectionNotice.style.display = 'none';
      
      // Reset seconds counter
      secondsLeft = 300; // 5 minutes
      
      // Only set up timers if we're on a large screen and protection is enabled
      if (!isLargeScreen || !protectionEnabled) return;
      
      // Set up the inactivity timer
      inactivityTimeout = setTimeout(() => {
        showPreActivationCountdown();
      }, 270000); // 4:30 minutes (270 seconds) - we'll show a countdown for the last 30 seconds
    }
    
    function showPreActivationCountdown() {
      // Show the notice
      protectionNotice.style.display = 'block';
      protectionNotice.style.opacity = '1';
      protectionNotice.textContent = 'Screen protection activating in 30 seconds...';
      
      // Show and start the countdown
      countdownCircle.style.display = 'block';
      secondsLeft = 30; // 30 seconds countdown
      updateCountdown();
      
      // Update the countdown every second
      countdownInterval = setInterval(() => {
        secondsLeft--;
        updateCountdown();
        
        if (secondsLeft <= 0) {
          clearInterval(countdownInterval);
          hideCountdown();
          startColorCycling();
        }
      }, 1000);
    }
    
    function updateCountdown() {
      countdownValue.textContent = secondsLeft;
      
      if (secondsLeft <= 10) {
        countdownValue.style.color = '#ff3860';
      } else {
        countdownValue.style.color = 'white';
      }
    }
    
    function hideCountdown() {
      protectionNotice.style.opacity = '0';
      setTimeout(() => {
        protectionNotice.style.display = 'none';
      }, 500);
      
      countdownCircle.style.display = 'none';
      clearInterval(countdownInterval);
    }
    
    // Event listeners to reset the inactivity timer
    ['mousemove', 'mousedown', 'keypress', 'touchstart', 'scroll', 'click'].forEach(evt => {
      document.addEventListener(evt, () => {
        if (isProtectionActive) {
          stopColorCycling();
        } else {
          resetInactivityTimer();
        }
      });
    });
    
    // Initial setup
    resetInactivityTimer();
    
    // For demo purposes - speed up the timer (uncomment to test quickly)
    /*
    setTimeout(() => {
      secondsLeft = 35; // Set to 35 seconds remaining
      showPreActivationCountdown();
    }, 5000); // Show countdown after 5 seconds
    */
  </script>
</body>
</html>
